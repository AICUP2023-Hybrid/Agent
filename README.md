### Sigma Agent

# Intro
This agent is developed for [AICup 2023](https://aicup2023.ir/) competition.
We used graph algorithms and probability theory to create robust strategies for a multi-player game similar to the Risk board game.

# Strategies
### Intro
Our main objective is to maximize ours and minimize our opponents' troop gain in each round. The whole strategy works by assigning a score to each candidate and choosing the one with the maximum utility, In addition to that we perform surprise attacks when the game can be won by capturing one or two strategic nodes in the current round.

### Methodology
For a node with `x` troops we calculate the expected casualty it would take to capture it. Using that we create a weighted directed graph with weights corresponding to `expected casualties(x)` and call it The `expected casualty graph`. The list of candidates is generated by extracting low-casualty defense and offense paths in this graph, also this graph can be utilized to estimate the amount of danger each of our nodes is in.

The scoring algorithm works by estimating the expected troop gain on the successful capture of a node and the damage that is caused to the other players. There are multiple tricks implemented here to make the algorithm time efficient like using matrix multiplication in probability calculations and custom-guided binary searches to find out the number of troops that are needed to save each node.

The concept of `danger` of a node $u$ —along with `attack power` of a player with a specified `src` and `tar` node— is one of the most important things we have defined, which has been utilized repeatedly in our algorithms. Let $P$ be the set of all players, then `danger(u)` is defined as follows (where $p$ is the player to which $u$ belongs, and $V_i$ is the set of all nodes belonging to the player $i$, and $U$ is the set of all nodes which are not occupied by any players):

$$danger(u) = \max\limits_{i \in P\setminus \{p\}} \max\limits_{v \in V_i \bigcup U} \texttt{attackpower}(i,v,u)$$

where attackpower of a player with the source node $v$ and the target node $u$ is defined as follows (where $\mathcal{P}^{i}_{vu}$ is the set of all feasible paths or straight attack plans for the player $i$, and $c_i$ is the estimated troops gained by the player $i$ when it's their turn after we finish):

$$attackpower(i,v,u) =  \max\limits_{0 \leq j \leq c} \max\limits_{path \in \mathcal{P}^{i}_{vu}}  (troops(v) + j) - \texttt{expected$\textunderscore$casualty}(path)$$

# One Strategic Attack


# Two Strategic Attack


# ThreePlus Attack
Since a sucessful attack gives us a 3 additional troops gains for the next round, an additional strategy to `One Strategic Attack` is provided in case no attack is performed in the previous strategies. Assuming we have $M$ troops to put in our turn, let $0 \leq i \leq M$ be a candidate number of troops to put in order to attack. Also, let $u$ be a node in which we are planning to place the $i$ troops on, with the initial troops $I$, and let $v$ be a neighboring node of $u$ that we wish to attack, with $J$ troops. We assosciate a score to the plan $(u,v,i)$ and choose the tuple with the maximum score. The loss is defined as follows ($c$ is the expected casualty of attacking $J$ troops with $I$ troops) :
$$loss(u,v,i) = c + 0.15 * (i - max(0, c - I))$$
And letting $w$ be the winning probability of attacking $J$ troops with $I$ troops, we have
$$score = 3 * w - loss$$
with the condition that $J \leq 4$ and $loss \leq 3$ (otherwise, we don't perform any attacks).

# Maximize Score


